{% extends 'base.html' %}
{% set hide_sidebar = True %}
{% set active_page = 'login' %}
{% block title %}Login{% endblock %}

{% block content %}

<style>
  
  .auth-wrap{
    min-height: clamp(520px, 80vh, 920px);
    display: flex;
    align-items: center;
    justify-content: center;
  }

  .login-card{
    width: 100%;
    max-width: 700px;
    border: 0;
    border-radius: var(--radius);
    box-shadow: var(--shadow);
    overflow: hidden; 
  }
</style>

<div class="auth-wrap container">
  <div class="card login-card">
   
    <div class="card-header bg-soft">
      <h1 class="h3 fw-bold mb-1 fs-2 text-brand">Sign in</h1>
      <p class="text-muted mb-0">Welcome back. Please enter your credentials.</p>
    </div>

    <div class="card-body p-4 p-md-5">
      <form action="{{ url_for('login') }}" method="post" novalidate>
        {% if next_url %}<input type="hidden" name="next" value="{{ next_url }}">{% endif %}

        <div class="mb-3">
          <label for="username" class="form-label">Username</label>
          <input type="text"
                 class="form-control form-control-lg"
                 id="username" name="username"
                 value="{{ username or '' }}" maxlength="50"
                 autocomplete="username" required>
        </div>

        <div class="mb-2">
          <label for="password" class="form-label">Password</label>
          <div class="input-group input-group-lg">
            <input type="password" class="form-control"
                   id="password" name="password"
                   placeholder="Enter your password"
                   autocomplete="current-password" required>
            <button class="btn btn-outline-secondary" type="button" id="togglePwd">Show</button>
          </div>
          <small id="capsHint" class="text-danger d-none">Caps Lock appears to be on</small>
        </div>

        <div class="d-flex justify-content-between align-items-center mt-2 mb-3">
          <label class="d-inline-flex align-items-center gap-2">
            <input type="checkbox" name="remember" value="1" class="form-check-input">
            <span class="subtle">Remember me</span>
          </label>
        </div>

        <div class="d-grid mt-2">
          <button type="submit" class="btn btn-activeloop btn-lg">Login</button>
        </div>
      </form>
    </div>

    <div class="card-footer bg-light text-center">
      New here?
      <a href="{{ url_for('signup', next=next_url) if next_url else url_for('signup') }}" class="fw-semibold text-brand">Create an account</a>
    </div>
  </div>
</div>

<script>
  document.getElementById('togglePwd')?.addEventListener('click', function(){
    const pwd = document.getElementById('password');
    const isText = pwd.type === 'text';
    pwd.type = isText ? 'password' : 'text';
    this.textContent = isText ? 'Show' : 'Hide';
  });
  document.getElementById('password')?.addEventListener('keyup', (e)=>{
    const on = e.getModifierState && e.getModifierState('CapsLock');
    document.getElementById('capsHint')?.classList.toggle('d-none', !on);
  });
</script>

{% endblock %}


